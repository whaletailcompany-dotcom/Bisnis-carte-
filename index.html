<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ù…ÙˆÙ„Ø¯ ØªØµØ§Ù…ÙŠÙ… Ø§Ø­ØªØ±Ø§ÙÙŠ Ù…Ø·ÙˆØ±</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<style>
  /* Reset */
  * { margin:0; padding:0; box-sizing:border-box; font-family:"Segoe UI", Tahoma, "Noto Naskh Arabic", sans-serif; }
  body { background:#0f172a; color:#fff; padding:15px; }

  /* Container */
  .container { max-width: 1200px; margin:auto; }

  header { text-align:center; margin-bottom:20px; }
  header h1 { font-size:24px; background:linear-gradient(135deg,#3b82f6,#8b5cf6); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
  header p { margin-top:5px; font-size:16px; color:#a1a1aa; }

  /* Form Panel */
  .panel { background:#1e293b; padding:20px; border-radius:10px; margin-bottom:20px; display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:15px; }
  .form-group { display:flex; flex-direction:column; }
  .panel label { display:block; margin-bottom:5px; font-weight:bold; font-size:14px; color:#94a3b8; }
  .panel input:not([type="color"]), .panel textarea, .panel select { width:100%; padding:10px; border-radius:6px; border:none; background:#334155; color:#fff; }
  .panel input[type="file"] { padding-top:10px; }
  .panel textarea { min-height:80px; }

  /* Buttons & Color Pickers */
  .panel button { padding:10px; border:none; border-radius:6px; cursor:pointer; font-weight:bold; width:100%; margin-top:10px; }
  .btn-primary{ background:linear-gradient(135deg,#3b82f6,#8b5cf6); color:#fff; }
  .btn-success{ background:#10b981; color:#fff; }
  .btn-danger{ background:#ef4444; color:#fff; }
  .color-picker-group { display:flex; align-items:center; }
  .color-picker-group input[type="color"] { width:40px; height:40px; border:none; padding:0; margin-left:10px; cursor:pointer; background:none; }

  /* Preview Section */
  .preview-container { display:flex; flex-wrap:wrap; gap:20px; justify-content:center; }
  .preview { border-radius:10px; padding:15px; margin-top:15px; box-shadow:0 4px 12px rgba(0,0,0,.3); position:relative; }
  
  /* Business Card */
  .card { width:340px; height:190px; padding:15px; border-radius:12px; display:flex; flex-direction:column; justify-content:space-between; transition:all 0.3s; }
  .card-top { display:flex; justify-content:space-between; align-items:center; }
  .card-info { margin-top:10px; }
  .card-info h2 { font-size:18px; margin-bottom:3px; }
  .card-info p { font-size:12px; margin-bottom:3px; }

  /* Card Templates (The powerful change) */
  .card.dark { background:#1f2937; color:#fff; border:1px solid #374151; }
  .card.light { background:#f3f4f6; color:#1f2937; border:1px solid #e5e7eb; }
  .card.colorful { background:#ef4444; color:#fff; border:1px solid #b91c1c; }
  .card.custom { transition:none; } /* Custom style logic is in JS */

  /* Flyer & CV */
  .flyer { width:210mm; height:auto; min-height:297mm; padding:30px; border:1px solid #ccc; background:#fff; color:#111; }
  .flyer h2 { font-size:28px; margin-bottom:15px; border-bottom:2px solid #3b82f6; padding-bottom:5px; }
  .flyer p { font-size:16px; line-height:1.6; }

  .cv { width:210mm; height:auto; min-height:297mm; padding:30px; border:1px solid #ccc; background:#fff; color:#111; }
  .cv h2 { color:#3b82f6; margin-top:15px; border-bottom:1px solid #3b82f6; padding-bottom:5px; }
  .cv p { margin-bottom:10px; font-size:14px; }
  .cv-section { margin-top:20px; }

  /* Circle images */
  .circle-img { width:60px; height:60px; border-radius:50%; overflow:hidden; border:3px solid #fff; object-fit:cover; }
  .logo-img { width:40px; height:40px; border-radius:50%; object-fit:cover; }

  /* FAB - Menu for Downloads */
  .fab { position:fixed; bottom:20px; left:20px; width:60px; height:60px; background:#3b82f6; border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer; font-size:30px; color:#fff; z-index:999; box-shadow:0 4px 12px rgba(0,0,0,.4); }
  .fab-menu { position:fixed; bottom:90px; left:20px; display:none; flex-direction:column; gap:10px; z-index:998; }
  .fab-menu.show { display:flex; }
  .fab-menu button { width:180px; text-align:right; }

  /* Responsive */
  @media (max-width:768px){ 
    .panel { grid-template-columns:1fr; } 
    .card{width:95%;height:auto;} 
    .flyer,.cv{width:100%;height:auto; min-height:auto; padding:15px;}
    .preview-container { flex-direction:column; align-items:center; }
  }
</style>
</head>
<body>

<div class="container">
  <header>
    <h1>âœ¨ Ù…ÙˆÙ„Ø¯ ØªØµØ§Ù…ÙŠÙ… Ø§Ø­ØªØ±Ø§ÙÙŠ (Ù…Ø·ÙˆØ±)</h1>
    <p>ØµÙ…Ù… Ø¨Ø·Ø§Ù‚Ø§Øª Ø¹Ù…Ù„ØŒ ÙÙ„Ø§ÙŠØ±ØŒ ÙˆØ³ÙŠØ± Ø°Ø§ØªÙŠØ© Ø¨ØªØ®ØµÙŠØµ Ø£ÙƒØ¨Ø±</p>
  </header>

  <div class="panel">
    <div class="form-group">
      <label>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label><input id="name" type="text" value="Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯">
    </div>
    <div class="form-group">
      <label>ğŸ’¼ Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ</label><input id="job" type="text" value="Ù…ØµÙ…Ù… Ø¬Ø±Ø§ÙÙŠÙƒ">
    </div>
    <div class="form-group">
      <label>ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label><input id="email" type="email" value="info@domain.com">
    </div>
    <div class="form-group">
      <label>ğŸ“± Ø§Ù„Ù‡Ø§ØªÙ</label><input id="phone" type="tel" value="+966 50 123 4567">
    </div>
    <div class="form-group">
      <label>ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹</label><input id="location" type="text" value="Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©">
    </div>
    <div class="form-group">
      <label>ğŸ”— Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label><input id="website" type="text" value="www.my-portfolio.com">
    </div>
    <div class="form-group" style="grid-column: span 2 / auto;">
      <label>ğŸ“ Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ù‡Ù†ÙŠ / Ù†Ø¨Ø°Ø©</label><textarea id="summary">Ù…ØµÙ…Ù… Ø¬Ø±Ø§ÙÙŠÙƒ Ø¨Ø®Ø¨Ø±Ø© 5 Ø³Ù†ÙˆØ§Øª ÙÙŠ Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¨ØµØ±ÙŠØ© Ù„Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„Ù†Ø§Ø´Ø¦Ø© ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„ÙƒØ¨Ø±Ù‰. Ø£Ø³Ø¹Ù‰ Ù„ØªÙ‚Ø¯ÙŠÙ… Ø­Ù„ÙˆÙ„ ØªØµÙ…ÙŠÙ… Ù…Ø¨ØªÙƒØ±Ø© ÙˆÙ…Ø¤Ø«Ø±Ø©.</textarea>
    </div>
    <div class="form-group">
      <label>âš¡ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª</label><input id="skills" type="text" value="Photoshop, Illustrator, InDesign, UI/UX">
    </div>
    <div class="form-group">
      <label>ğŸ“· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©</label><input id="photo" type="file" accept="image/*">
    </div>
    <div class="form-group">
      <label>ğŸ¨ Ø§Ù„Ø´Ø¹Ø§Ø± / Ø§Ù„Ù„ÙˆØ¬Ùˆ</label><input id="logo" type="file" accept="image/*">
    </div>

    <div class="form-group">
      <label>ğŸ¨ Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</label>
      <select id="template">
        <option value="dark">1- Ø¯Ø§ÙƒÙ† (Dark)</option>
        <option value="light">2- ÙØ§ØªØ­ (Light)</option>
        <option value="colorful">3- Ù…Ù„ÙˆÙ† (Colorful)</option>
        <option value="custom">4- Ù…Ø®ØµØµ (Custom)</option>
      </select>
    </div>
    <div class="form-group color-picker-group">
      <label>Ù„ÙˆÙ† Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Custom)</label>
      <input id="primaryColor" type="color" value="#3b82f6">
    </div>
    <div class="form-group color-picker-group">
      <label>Ù„ÙˆÙ† Ø§Ù„Ù†Øµ (Custom)</label>
      <input id="textColor" type="color" value="#ffffff">
    </div>
    
  </div>

  <div class="preview-container">
    <div class="preview card dark" id="cardPreview">
      <div class="card-top">
        <img id="photoPreview" class="circle-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©">
        <img id="logoPreview" class="logo-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="Ø§Ù„Ø´Ø¹Ø§Ø±">
      </div>
      <div class="card-info">
        <h2 id="cardName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</h2>
        <p id="cardJob">Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ</p>
        <div style="font-size:12px; margin-top:8px;">
            <p id="cardEmail">ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯</p>
            <p id="cardPhone">ğŸ“± Ø§Ù„Ù‡Ø§ØªÙ</p>
            <p id="cardLocation">ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹</p>
        </div>
      </div>
    </div>

    <div class="preview flyer" id="flyerPreview">
      <h2 id="flyerName">Ø§Ù„Ø§Ø³Ù… â€” Ø§Ù„Ù…Ø³Ù…Ù‰</h2>
      <p style="color:#555; margin-bottom:20px;">*Ø§Ù„ÙÙ„Ø§ÙŠØ± ÙŠØ±ÙƒØ² Ø¹Ø§Ø¯Ø©Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØªØ±ÙˆÙŠØ¬ Ù„Ø®Ø¯Ù…Ø© Ø£Ùˆ Ù…Ù†ØªØ¬.</p>
      <p id="flyerSummary">Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ù‡Ù†ÙŠ</p>
      <div style="margin-top:25px;">
        <p style="font-weight:bold; color:#3b82f6;">Ù„Ù„ØªÙˆØ§ØµÙ„:</p>
        <p id="flyerPhone">Ø§Ù„Ù‡Ø§ØªÙ: </p>
        <p id="flyerEmail">Ø§Ù„Ø¨Ø±ÙŠØ¯: </p>
        <p id="flyerWebsite">Ø§Ù„Ù…ÙˆÙ‚Ø¹: </p>
      </div>
    </div>

    <div class="preview cv" id="cvPreview">
      <h1 id="cvName" style="text-align:center; color:#3b82f6; border-bottom:2px solid #3b82f6; padding-bottom:10px;">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</h1>
      <p id="cvJob" style="text-align:center; color:#555; margin-bottom:20px;">Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ</p>
      
      <div class="cv-section">
        <h2>Ù†Ø¨Ø°Ø© Ù…Ø®ØªØµØ±Ø©</h2>
        <p id="cvSummary"></p>
      </div>

      <div class="cv-section">
        <h2>Ù…Ù‡Ø§Ø±Ø§Øª Ø±Ø¦ÙŠØ³ÙŠØ©</h2>
        <p id="cvSkills" style="font-style:italic;"></p>
      </div>
      
      <div class="cv-section">
        <h2>ØªÙˆØ§ØµÙ„</h2>
        <p id="cvPhone">ğŸ“± Ø§Ù„Ù‡Ø§ØªÙ: </p>
        <p id="cvEmail">ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯: </p>
        <p id="cvLocation">ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹: </p>
        <p id="cvWebsite">ğŸ”— Ø§Ù„Ù…ÙˆÙ‚Ø¹: </p>
      </div>
    </div>
  </div>
</div>

<div class="fab" id="fab">ğŸ“¥</div>
<div class="fab-menu" id="fabMenu">
  <button class="btn-success" onclick="downloadCardPNG()">ğŸ“¥ Ø¨Ø·Ø§Ù‚Ø© PNG</button>
  <button class="btn-success" onclick="downloadCardPDF()">ğŸ“¥ Ø¨Ø·Ø§Ù‚Ø© PDF</button>
  <button class="btn-success" onclick="downloadCVPDF()">ğŸ“¥ CV PDF</button>
  <button class="btn-primary" onclick="exportZIP()">ğŸ“¦ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙƒÙ„ ZIP</button>
</div>

<script>
  // ===================================
  //           Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  // ===================================
  let photoData = null, logoData = null;

  const photoInput = document.getElementById("photo");
  const logoInput = document.getElementById("logo");
  const photoPreview = document.getElementById("photoPreview");
  const logoPreview = document.getElementById("logoPreview");
  const templateSelect = document.getElementById("template");
  const primaryColorInput = document.getElementById("primaryColor");
  const textColorInput = document.getElementById("textColor");
  const cardPreview = document.getElementById("cardPreview");
  
  // ÙˆØ¸ÙŠÙØ© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±
  function handleFileInput(input, preview, callback){
    input.addEventListener("change", e=>{
      const reader = new FileReader();
      reader.onload = ()=>{ 
        callback(reader.result);
        preview.src = reader.result; 
      }
      reader.readAsDataURL(e.target.files[0]);
    });
  }

  handleFileInput(photoInput, photoPreview, (data) => { photoData = data; });
  handleFileInput(logoInput, logoPreview, (data) => { logoData = data; });

  // ÙˆØ¸ÙŠÙØ© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
  function updateAll(){
    const nameVal = name.value || "Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„";
    const jobVal = job.value || "Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ";

    // --- ØªØ­Ø¯ÙŠØ« Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¹Ù…Ù„ ---
    document.getElementById("cardName").textContent = nameVal;
    document.getElementById("cardJob").textContent = jobVal;
    document.getElementById("cardEmail").textContent = "ğŸ“§ " + (email.value || "Ø§Ù„Ø¨Ø±ÙŠØ¯");
    document.getElementById("cardPhone").textContent = "ğŸ“± " + (phone.value || "Ø§Ù„Ù‡Ø§ØªÙ");
    document.getElementById("cardLocation").textContent = "ğŸ“ " + (location.value || "Ø§Ù„Ù…ÙˆÙ‚Ø¹");
    
    // --- ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙÙ„Ø§ÙŠØ± ---
    document.getElementById("flyerName").textContent = nameVal +" â€” "+ jobVal;
    document.getElementById("flyerSummary").textContent = summary.value || "Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ù‡Ù†ÙŠ";
    document.getElementById("flyerPhone").textContent = "Ø§Ù„Ù‡Ø§ØªÙ: " + (phone.value || "N/A");
    document.getElementById("flyerEmail").textContent = "Ø§Ù„Ø¨Ø±ÙŠØ¯: " + (email.value || "N/A");
    document.getElementById("flyerWebsite").textContent = "Ø§Ù„Ù…ÙˆÙ‚Ø¹: " + (website.value || "N/A");


    // --- ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ© (CV) ---
    document.getElementById("cvName").textContent = nameVal;
    document.getElementById("cvJob").textContent = jobVal;
    document.getElementById("cvSummary").textContent = summary.value || "Ù…Ù„Ø®Øµ Ù‚ØµÙŠØ±... (ÙŠÙØ¶Ù„ Ø¥Ø¯Ø®Ø§Ù„ ØªÙØ§ØµÙŠÙ„)";
    document.getElementById("cvSkills").textContent = skills.value || "Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª ØºÙŠØ± Ù…Ø¯Ø®Ù„Ø©.";
    document.getElementById("cvPhone").textContent = "ğŸ“± Ø§Ù„Ù‡Ø§ØªÙ: " + (phone.value || "N/A");
    document.getElementById("cvEmail").textContent = "ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯: " + (email.value || "N/A");
    document.getElementById("cvLocation").textContent = "ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹: " + (location.value || "N/A");
    document.getElementById("cvWebsite").textContent = "ğŸ”— Ø§Ù„Ù…ÙˆÙ‚Ø¹: " + (website.value || "N/A");


    // --- ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù† ---
    applyTemplate();
  }

  // ÙˆØ¸ÙŠÙØ© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù‚Ø§Ù„Ø¨ ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù† (Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¬ÙˆÙ‡Ø±ÙŠ)
  function applyTemplate() {
    const template = templateSelect.value;
    const primaryColor = primaryColorInput.value;
    const textColor = textColorInput.value;

    // Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ ÙØ¦Ø§Øª Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨
    cardPreview.classList.remove("dark", "light", "colorful", "custom");
    cardPreview.style.backgroundColor = '';
    cardPreview.style.color = '';
    cardPreview.style.border = '';
    cardPreview.querySelectorAll('h2, p').forEach(el => el.style.color = '');
    cardPreview.querySelectorAll('.circle-img').forEach(el => el.style.borderColor = '');


    if (template === "custom") {
      cardPreview.classList.add("custom");
      cardPreview.style.backgroundColor = primaryColor;
      cardPreview.style.color = textColor;
      cardPreview.style.border = `1px solid ${primaryColor}`;
      // ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…Ø­Ø¯Ø¯
      cardPreview.querySelectorAll('h2, p').forEach(el => el.style.color = textColor);
      // Ø¬Ø¹Ù„ Ø­Ø¯ÙˆØ¯ Ø§Ù„ØµÙˆØ± Ø¨Ù†ÙØ³ Ù„ÙˆÙ† Ø§Ù„Ù†Øµ Ø£Ùˆ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
      cardPreview.querySelectorAll('.circle-img').forEach(el => el.style.borderColor = textColor);
    } else {
      // ØªØ·Ø¨ÙŠÙ‚ ÙØ¦Ø© Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ© (dark, light, colorful)
      cardPreview.classList.add(template);
    }
    
    // ØªØºÙŠÙŠØ± Ù„ÙˆÙ† CV ÙˆØ§Ù„ÙÙ„Ø§ÙŠØ± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ø­Ø³Ø¨ Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…Ø®ØªØ§Ø± Ø­ØªÙ‰ Ù„Ùˆ Ù„Ù… ÙŠÙƒÙ† Ù…Ø®ØµØµ
    document.querySelectorAll('.flyer h2, .cv h1, .cv h2').forEach(el => el.style.color = primaryColor);
    document.querySelectorAll('.flyer h2').forEach(el => el.style.borderColor = primaryColor);
    
  }

  // Ø±Ø¨Ø· Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
  document.querySelectorAll("input,textarea,select").forEach(el=>{
    el.addEventListener("input", updateAll);
  });
  primaryColorInput.addEventListener("input", updateAll);
  textColorInput.addEventListener("input", updateAll);


  // ===================================
  //           Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØ­Ù…ÙŠÙ„
  // ===================================

  // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù€ scale Ø¥Ù„Ù‰ 3 Ù„ØªØ­Ø³ÙŠÙ† Ø¬ÙˆØ¯Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© (DPI)
  async function savePNG(el, file){
    const canvas = await html2canvas(el, {scale:3, backgroundColor:null});
    canvas.toBlob(b=>saveAs(b,file));
  }

  // ØªØ­Ø³ÙŠÙ† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù€ PDF Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¹Ù…Ù„ ÙˆØ§Ù„ÙÙ„Ø§ÙŠØ±/CV
  async function savePDF(el,file){
    const {jsPDF} = window.jspdf;
    const canvas = await html2canvas(el,{scale:3, backgroundColor:null});
    const img = canvas.toDataURL("image/png");
    
    if (el.id === "cardPreview") {
        // ØªÙ†Ø³ÙŠÙ‚ Ù‚ÙŠØ§Ø³ÙŠ Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¹Ù…Ù„ (85mm x 50mm)
        const pdf = new jsPDF({orientation:'landscape', unit:'mm', format:[85, 50]});
        const imgWidth = 85;
        const imgHeight = 50; 
        pdf.addImage(img,"PNG",0,0,imgWidth,imgHeight);
        pdf.save(file);
    } else {
        // ØªÙ†Ø³ÙŠÙ‚ A4 Ù„Ù„ÙÙ„Ø§ÙŠØ± ÙˆØ§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©
        const pdf = new jsPDF({orientation:'portrait', unit:'mm', format:'a4'});
        const imgWidth = 190;
        const imgHeight = canvas.height * imgWidth / canvas.width;
        pdf.addImage(img,"PNG",10,10,imgWidth,imgHeight);
        pdf.save(file);
    }
  }

  async function downloadCardPNG(){ await savePNG(cardPreview,"business-card.png"); }
  async function downloadCVPDF(){ await savePDF(document.getElementById("cvPreview"),"cv-resume.pdf"); }

  // ØªÙ… Ø¯Ù…Ø¬ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙ„Ø§ÙŠØ± ÙˆØ§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ© ÙÙŠ Ù…Ù„Ù PDF ÙˆØ§Ø­Ø¯ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø®ÙŠØ§Ø±Ø§Øª Ù‚Ù„ÙŠÙ„Ø© Ù‚ÙˆÙŠØ©
  async function exportZIP(){
    const zip = new JSZip();
    async function add(el,name){
      const canvas = await html2canvas(el,{scale:3, backgroundColor:null});
      zip.file(name+".png", canvas.toDataURL("image/png").split(",")[1], {base64:true});
    }
    await add(cardPreview,"business-card");
    await add(document.getElementById("cvPreview"),"cv-resume");
    const content = await zip.generateAsync({type:"blob"});
    saveAs(content,"all-designs.zip");
  }

  // ===================================
  //           Ù…Ù†Ø·Ù‚ Ø²Ø± FAB
  // ===================================
  const fab = document.getElementById("fab");
  const fabMenu = document.getElementById("fabMenu");
  fab.addEventListener("click", ()=>{
    fabMenu.classList.toggle("show");
  });

  document.addEventListener("click",(e)=>{
    if(!fab.contains(e.target) && !fabMenu.contains(e.target)){
      fabMenu.classList.remove("show");
    }
  });

  window.addEventListener("load", updateAll);
</script>

</body>
    </html>
                
